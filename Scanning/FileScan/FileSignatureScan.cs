using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Security.Cryptography;
using System.Text;
using System.Threading.Tasks;
using Wildlands_System_Scanner.Constants;

namespace Wildlands_System_Scanner.Scanning.FileScan
{
    public class FileSignatureScan
    {
        public static void SignatureScan()
        {
            CheckFileHashes(FileConstants.ExplorerFile,
                "A36E0D372EF2E31690D642220EF482AB|BCACBDB782A0D1AD4EBBEE43DA490876|044012CDAB5ADE610782EAFA1C384CB5|2AC8E2DE1A3C2DDE2C37568AB007153F|B8744AC6493A5126DA7E2349D3DCAA9A|710CD555C00C29C59152DD50CAA553ED|11C8E05CE261AA96A47BB6196E906579|66D168B3A5CAF573FD8399BDCB9269A7|1473B9D949F2480A92B876DCC0682532|9F1D18583C7DDB8FC8DA09A37A830EDB|33B132BE164983BA14F732253E786DFE|5E6C45B6B2F9BEA0650CF2279ADE678B|170A2515F8C7B58697E45720A8324FEB|499B0D1F6277F17B3BAC525B8717C064|F173C38E9BAA09191312B3E706C1DFD5|166AB1B9462E5C1D6D18EC5EC0B6A5F7|E79CC4B9A9EAA1E5D801742C093043A9|EE1258224916C55F4251ACE1153620A9|51BF1A2C033F61A7CF665244731D6C8E|91E24273FCA076EA9E65DAFA98901225|042216FBB8B0CCC7402C3C77E58E1BC9|6DDCA324434FFA506CF7DC4E51DB7935|B118183E015EE8EE5EE0FB650C2D8813|9180E7A47852FC2EBDAEF0B1F0D146BD|2A156D5EBF221EF2A6AE7CE452324DAC|49A9479F4044CC5734DF2FA0831B5F61|FCBCED2A237DCD7EF86CED551B731742|119E091B5386379BC5AA598BE9440C75|1A0BC9598E4A58FC84570FFF5A108E58|a0732187050030ae399b241436565e64|12896823fb95bfb3dc9b46bcaedc9923|712B0D2ADE5297563168C997DDC2DD13|FFA764631CB70A30065C12EF8E174F9F|f2317622d29f9ff0f88aeecd5f60f0dd|EAFE46B0292D2BD2467835E2ACF717CC|953ADECFF08202A01EFC6110214FDE02|40D777B7A95E00593EB1568C68514493|D07D4C3038F3578FFCE1C0237F2A1253|37440D09DEAE0B672A04DCCF7ABF06BE|2AF58D15EDC06EC6FDACCE1F19482BBF|8B88EBBB05A0E56B7DCC708498C02B3E|2626FC9755BE22F805D3CFA0CE3EE727|4F554999D7D5F05DAAEBBA7B5BA1089D|15BC38A7492BEFE831966ADB477CF76F|9CF221011009E82742CDE1BA4AE94F5C|690ce9eb3d49ad59c0a9172d2b5ec01e|09225cd745c09bdbf5cecf784e4004a7");

            CheckFileHashes(FileConstants.WinlogonFile,
                "7F6282E70C3679E7814BF01FF92142C5|FAE691B2AF31F988A6761D80AEBF8A90|908475769DD71D1B0DD15EB7052F43A1|8C0712A3255AD1354E324C729B214EF8|C5A164338B12BFBEBA2EB55757A27E8B|BBE5109388E80A7EB695F35AE87AAC7C|7CB27503100261CA84BFA0D433551913|52B91F8DA4956FB791C308ADC45D9280|E65B8ADD03546423F3D4F697A72BB4A5|4DD928C44EEA6190A8E140DCAFF31A0D|AB6A3D4C3986DD5C460C578CEC19B88E|FC9D2D5A9C1F4759A6776E5BCA5C4230|DCD4DD0EE276A3FA74B00C3E1680088C|26FBE96E2899C3BA494C9B61EF3005F0|71729EBE5B8F5B05CEF9FCF39AD030BA|C7B38F105DFDD3231314EDDF7012D8AA|2022624E358053908CB81B4E02245B8F|608410546A867BEF11D0DE6682AF24EE|734300A2572CE21988C36BD1B756429D|DB876C1B7FA5CD1BD79D8C942E39908C|E36FB29A2158B7D5DCA0F4E08DE75442|930ED53FC2A24FF4BA66131E031CD14C|66FC7843E349C68F424EB79E0A17D8D2|52449FD429D6053B78AE564DEF303870|998507B046BA314CE8245364C686FA67|70C57DC69D4A7D92D2CAC90C3AD16E6F|01c3346c241652f43aed8e2149881bfe|ed0ef0a136dec83df69f04118870003e|6D13E1406F50C66E2A95D97F22C47560|94385F95EF948FB274A70DE3EDE5696D|87DA6ACA9AF2F536C68471787D1B3F4A|898E7C06A350D4A1A64A9EA264D55452|9F75392B9128A91ABAFB044EA350BAAD|37CDB7E72EB66BA85A87CBE37E7F03FD|C2610B6BDBEFC053BBDAB4F1B965CB24|8EC6A4AB12B8F3759E21F8E3A388F2CF|09D592F8CEE432C7AB824043F988638F");

            CheckFileHashes(FileConstants.WininitFile,
                "5334DDB7BD791C5AB8B82E78BF42D563|62CAAC112386ABF50F635D05F0C67CC8|892A73A1CB162CEA5DDABE9042D8ED53|C2B777E41BF6A4A2B73AA500BBD84F00|BC94EFD0E6AFBE876713821C77F81E53|127B9C203C5A3D65783BB7E7A833FF47|81315A6E6A058797CEFB213FC3654307|8A60D4136E37C3CCB1ECAE90D11618F4|ED867D527027DBAB6CF9CB7AAC85B89E|DC02677945BDABD6B0C6A29914AA21EF|75766ADB5250CD43F68648AF9AC02695|DE3A10032AE77199B1E7FBC8D6E21636|B5C5DCAD3899512020D135600129D665|02BC073156B3097E94D63C4D609020DD|7109FF769FFF962869C50D720F7AA7D7|101BA3EA053480BB5D957EF37C06B5ED|D4385B03E8CCCEE6F0EE249F827C1F3E|F533479646437BAA9E0CF00D4363D7BA|583b60a43f502d90331e6589e1dbc6dd");

            CheckFileHashes(FileConstants.SvchostFile,
                "5465B544907B32F8665635A68EA623B1|A7296C1245EE76768D581C6330DADE06|23E47CE30CFC49F60A6E24B50AA83B9B|FA6C268A5B5BDA067A901764D203D433|15556928CB0E9F74F4036411D8CC111E|9E597749A44C4A39948917B5F30DE1CC|51EEFC52268490E767D5587C9CFF4376|6BDB3091562E7DD2C877472286B6CC46|D0ABC231C0B3E88C6B612B28ABBF734D|A412DEDAC6A1FF7BA06FEB3B6725495E|6A1212077C0559029CDFB9C39580C835|8f078ae4ed187aaabc0a305146de6716|27c6d03bcdb8cfeb96b716f3d8be3e18|e4bdf223cd75478bf44567b4d5c2634d|425E22D9F5C01616AFC92987791B19E9|A46DC432F81473F526E3994AA483E366|10DA15933D582D2FEDCF705EFE394B09|54A47F6B5E09A77E61649109C6A08866|3794B461C45882E06856F282EEF025AF|D5B55F18A7CD2A6F4019B17BAEEDC2F3");

            CheckFileHashes(FileConstants.ServicesFile,
                "0EA6A18D7F998B059BB086D17082F90C|3C3E0667C8B2A503B32EFC38D2072D22|7364EA83AF7C029D1B23B85D649C846B|643590F7C71A67EB409803F7E8D2BCE7|3C6917A060C4426BABED998D56A92AD2|AD5C05DBE149D77FC1C183015272BB00|DDA10A2CCED837B3DED2652825EDA783|5B3AA7D1256183819A8C6749315FD26B|634ACCB0BB2CE8BED6D5BD63B5CE7C40|9E597749A44C4A39948917B5F30DE1CC|6CFCD83FA724233ED5BE0D7361E3FE3F|5C317303AC6C7EF74930288E44791483|36F1E043A50A2CBFF180564A2A1EC924|3F7DFCC49334A83CF9CA1213A70CBC9E|E87903F522285387892454272246EE92|38B79CC853C284A7985C938E94EC8F6A|0004C4CAC8AFAA2187957BBDFE57919E|C6D7FC158BEADFCBAD70CF76629728BB|C261E6D15E5B8DBDD55F2105F0C2AF4D|9800EE022CEEA27105A1BAC898E98EF7|A49A7FF0A8CF7C4BC9864B7F89B7F8DA|0780A42DBD7D9969F9BF4A19AA4285B5|48A5107E71E1F6581D739003191B4610|0B202554398DBFDEE5777CDC2E6C8254|37561f8d4160d62da86d24ae41fae8de|0e776ed5f7cc9f94299e70461b7b8185|65df52f5b8b6e9bbd183505225c37315|c3fb1d70cb88722267949694ba51759e|020ceaaedc8eb655b6506b8c70d53bb6|271DDD0B858CA6A6FF5D8CB04BE887C6|329CF3C97CE4C19375C8ABCABAE258B0|6528BAACA25356FE226904DD36C82BA7|5F1B6A9C35D3D5CA72D6D6FDEF9747D6|D4E6D91C1349B7BFB3599A6ADA56851B|2B336AB6286D6C81FA02CBAB914E3C6C|B9B3EF6215ED2F53A55BF5ACE2536A5F");

            CheckFileHashes(FileConstants.User32File,
                "B47AD1BEC0AB839A9C30C6D9A9E4F45E|6410C96D15B0A165916F4EE283031374|C884DE582E0C21D8894B9245C05B4B33|B58A4C64D6CA6278929CC8B0D1DBBC7C|C94C1D06D472895625D1B33C3B24EB9F|CA1B54B0B3A8D42A2A1607604AEEF038|A81EF1F0BE29CB8E4685D9D7213C5540|E4DD65F1D80FFAB62448A667D5865309|F6503644E50AA54ED99E9EFAB1F64717|620BC21FE1122EB9A8A1756283468A5E|6E890421E1788C34214158C6F51CE50A|CC157E3445C86456494ED940E1250247|50AD28D9BB854DE1AFB25574C2AB9AB1|6BDE2EEC2BDB9D2198BFF08C208A3F56|AF95FA8614628DEC77007448469C099F|6959A23482E0E9F95C330F6D9C99D66B|C2F33F76F3D21A894400DBBC224F4CFA|2338D3F2CAB3D2202331E1D7B46C1A64|614225860D6E4850CBF8F49EE0F5F12A|9C072D156706D09CA3F753025AE9E119|DF28DBDB9ADC0DE0099D61B37EFBCBBB|DCD83C000CA07E1101C4796937D58815|A046A3052B33CCADAF74706BF209E46E|9E8235848E1A68832BCEAE369F5953E5|28E9E9FC383DFDA047B13CDEAE318B08|C1B4AECDE937261257CF7EC7F9320CB6|91D4629DA1EBD286D8A7C24FBC5DC641|D4612B2696E234CC616BD15D9AB9DF1E|A195F0BE9519A6D1E53B41286E1E3B02|274A5FEE7293699C189317CE75666097|4C5A23AE4F5157F579C89736EA5D42CE|07015CC43E9CFBF144807EC17E679053|794D6891102C4CA040C64CB76966CC58|43B0EB86B10506AD564E2005A6156D30|c72661f8552ace7c5c85e16a3cf505c4|b26b135ff1b9f60c9388b4a7d16f600b|63B4F59D7C89B1BF5277F1FFEFD491CD|CAC777BAD7B0E57D3378CDD8FDDB117C|CD4D76A22C3DB441EBF287CE4FDEF209|F1DD3ACAEE5E6B4BBC69BC6DF75CEF66|75510147B94598407666F4802797C75A|34B7E222E81FAFA885F0C5F2CFA56861|7BD7F45FF37FA0669CD32CA0EF46E22C|B974D9F06DC7D1908E825DC201681269|6679ED921B3BA43880537622812B0AE5");

            CheckFileHashes(FileConstants.UserinitFile,
                "05D02F412A916B7322AB94E5D8EA9767|A83702100F695127901004594BAF8E84|2FA05B1CFC52E590E090705EA56F5B02|B01FC72D5368EFED56F253D5A9D4CB60|5495BEE081B682FADE7B79C331711D2B|61E7F56A1C00894FCB212F25BB52EE68|D10643FC0095434C819316CA6CD748C0|A89C18F5E6D8981D5E937B325290915A|A878CF325C93723B5017642E6FDB80E8|C37AEE5966EB5929E2051AC7409B5730|a93aee1928a9d7ce3e16d24ec7380f89|9F6289D194A04A09671FEED4B6CB6EF7|41636F77AD6D9A396EA34E4786B96F2B|e74ddb12188c2ff57a78624dbf7332fc|22027835939F86C3E47AD8E3FBDE3D11|61AC3EFDFACFDD3F0F11DD4FD4044223|6DE80F60D7DE9CE6B8C2DDFDF79EF175|0E135526E9785D085BCD9AEDE6FBCBF9|782E2A50EA4AE8AA5A9646413A7822C1|39b1ffb03c2296323832acbae50d2aff");

            CheckFileHashes(FileConstants.RpcssFile,
                "E5BECB45B3519C4F3013E89B9378D1B4|8870F4D3FB2552C68C57DB279A8E75CC|D3C50EC8B4378B189B6F4D9DAB0D211C|C5F45B2084098FB910FC298220CEAB6A|F7D644D84991AB87513A0BC489265A54|13A5D81F0BD10F1D71F801EAD0314148|99D5CFFDF71346DA5FC528821528F88D|51A51B022BE72719E50ADD78CC2190DF|0C4956E90E4D01484AF6B085E0F015EA|A06443C79816B9FE658C91316BE866A8|A26177041090A7FDF858312CE07DA599|1DDE5FCBEE97E1F9A24905C039850FBC|A445B07E2D10C70A12FC7E466052F990|9884F2ADC1945C389F2171F5B66B48F5|F81D38383AC268AB1E14B6E5B15C01B1|B4EDA5E211E7859724777724D5A2B069|400633E0C409FCFE253CDD11C86CD122|967DA08691ACCBC1118098DCA7B41C17|405B763627BA35E56CAC22FA7D1BA1B4|0395B42B3885269C039C6705D5A49BE3|F008D9CF999E904824548D1FA732F205|5E9F8D029D9B03110D835CBFC058068B|8E9D9775262B02A7D7DF8A83E6A6FB5C|624301FFCFCAA95AD273B3B8DB6D09C0|9A0F6B739BA65CD8678381276A457D90|EDBB1DB3864C0FBF54BF8F05B1519FD3|E5D48E15A7D92BD0411A66ABD39E0D4E|1F54F58D7FA2B3442084E32CDE5E309E|34E26E472DB5C01FAD58809285DBC0A4|4C0499B1D34B8E097DAD8B26DC26BCB2|05C0337538BEECC04FC695808EFF201C|301AE00E12408650BADDC04DBC832830|bc4e0226341aaec1222336b3aed86bab|B5F06957525D494D2C261B5739367524|be27674d1cbc3214aec84b4336a38bbf|6b27a5c03dfb94b4245739065431322c|d8d28f6cabec7d42b8e487e290563b9a|33FB1F0193EE2051067441492D56113C|3B5B4D53FEC14F7476CA29A20CC31AC9|BCD3562ACB27B8137BF809F61BA44E80|7660F01D3B38ACA1747E397D21D790AF|7B981222A257D076885BFFB66F19B7CE|B82CD39E336973359D7C9BF911E8E84F|2589FE6015A316C0F5D5112B4DA7B509|52CDADE8289FF21F1F2215FF51A5F36C|9222562D44021B988B9F9F62207FB6F2|83FCF3BA97BA09D54B2683D61465C93C|5c83a4408604f737717ab96371201680");

            CheckFileHashes(FileConstants.DnsapiFile,
                "4116BF1EEA2BA39A56C83274AA6D92D8|27618FAE442F44C1A4B7C428A4030991|1478BADEF19E84593B9174B24A50F1D7|23F45825244CFCB11CC6355690F3FFAB|8ECD87F592CF60DA7CCFB3AC80A52C10|23E73E7D3B304E661DC14F8D7217872C|E38864C62641DF22A4AFD2B6C59BD61B|A4CB6481213A18FA184CBE82A972DB20|4A35D7B172AFF9C6B362D7297568836A|052495BF199C5369F9C86BF9B26F2A3A|B668D6FD24465E11155B47808553DA61|BE663A3C8E4F3ED2E8404A808614BCE3|E393B53837F6778C8FE0B27B58478B37|CCF0DECFEB3D31F4CB733B39EFDFBAB3|66342F3BB289A5A370127F8385512A84|0A821BF024E347943D6F5C5180FAEA31|F2E67F682DDCFE2C2C170F2AA3650ED6|205BDB00F4C032AF45A6BFD18EA7886C|7610A035A4D37B5ECC7CED7430C37E49|3F969D5ADEAB3284ABD500B37D74A8F8|0BE9606A1175C7400ED862991453A847|FF0EE1B87E5DD7A82F7BB124D5CA8BB6|BD9C7A068C46053F8747CEA73B5930AB|BB5BBD0E4D04047585E4ED0F07AA51E7|6A7ACABAE92C837F5C1330188EAE36AE|BB3717D6FC27A22D0403C825A93BC068|B8CBE3E85857EC7139EEF68FB650151E|389496118B3B03C2328024AF320132AC|0A3325D38DB90792BBBE01334F273974|C76735BFB7214907B4590DD35AE64A79|64AA11D53A4A84CDF43370D7036517C3|1F79F611109C2B97260B68FD6B4FC7DD|B40420876B9288E0A1C8CCA8A84E5DC9|59DF156711A76BCB993253EC6C9BBF41|11DD7EB4446F25C132D0D8527DDCAF4D|62390F4ACE9E2B63E3CA26B7F7497897|6D5A49D6479EB753C7879F73A4C35E0F");

            CheckFileHashes(FileConstants.DllhostFile,
                "BE467A8F33CDEB0538E98CF10101E9E0|60D0B50CFF3A0722ADC274F49FB16F14|CC05C14EEFF5E7813A49718BA88E59B0|B5A6D2FB3F4521C37D613DE52AB3467D|A63DC5C2EA944E6657203E0C8EDEAF61");

            CheckFileHashes(FileConstants.VolsnapFile,
                "C67BEC6413CACF77BFA1B0EC18F771DA|F76A8A3DA3A1A451EACAEF328EA33DC2|3114CEB6A1426D3051A1164971B6220E|CB2361370D7105144F1F4B5F185A4AA0|5C98852C88786EDB510CBBC871E8052D|50BA19F07101C377F7664FF78CCCBA3F|134523B18C89C4E1E46C4AA5CA048F49|DE1770C753FBBB197FD16A02422A9962|297733CDBC2CB765F7B58DDA60DBF5AE|577A6128809F7014CE409C0252945CF4|F4C6A1AE619F644C1C4A5F18171AD078|74648E3F919A2CBA68BADBC8E6C7CC03|BF079843E272759BAE587FB980163293|31A2AA48C1ECD390E2707E5C21B75DCE|12999D4773D8034431795440A3DF910A|2E5522E831E616B37F06908B7B56C3B3|085918BF459BCB835CFC535BE7138539|4c8fcb5cc53aab716d810740fe59d025|46de1126684369bace4849e4fc8c43ca|C37AEE5966EB5929E2051AC7409B5730|5F9A69B5C5C34197037A7EA36F4A7BE7|59F06B4968E58BC83DFC56CA4517960E|786DB5771F05EF300390399F626BF30A|C9C8573006D7A8391AFE35D99036B6A0|F497F67932C6FA693D7DE2780631CFE7|8E15C3D58A8ADE841060661DBA6E7A9B|147281C01FCB1DF9252DE2A10D5E7093|80DC0C9BCB579ED9815001A4D37CBFD5|58DF9D2481A56EDDE167E51B334D44FD|D8B4A53DD2769F226B3EB374374987C9|A6E7BB5A3A534F81713104C5E0BF6450|ee4660083deba849ff6c485d944b379b");

            CheckAdditionalFiles();

        }

        private static void CheckFileHashes(string filePath, string knownHashes)
        {
            if (File.Exists(filePath))
            {
                string fileHash = GetFileMD5Hash(filePath);
                if (knownHashes.Split('|').Contains(fileHash, StringComparer.OrdinalIgnoreCase))
                {
                    Logger.Instance.LogPrimary($"File {filePath} is verified to be clean.");
                }
                else
                {
                    Logger.Instance.LogPrimary($"File {filePath} is infected.");
                }
            }
            else
            {
                Logger.Instance.LogPrimary($"File {filePath} does not exist.");
            }
        }

        public static string GetFileMD5Hash(string filePath)
        {
            if (!File.Exists(filePath))
            {
                throw new FileNotFoundException("File not found.", filePath);
            }

            using (var md5 = MD5.Create())
            using (var stream = File.OpenRead(filePath))
            {
                byte[] hashBytes = md5.ComputeHash(stream);
                return BitConverter.ToString(hashBytes).Replace("-", "").ToUpperInvariant();
            }
        }



        private static void CheckAdditionalFiles()
        {
            string systemDir = Environment.GetFolderPath(Environment.SpecialFolder.System);
            string osName = Environment.OSVersion.VersionString;

            if (osName.Contains("10"))
            {
                // Add specific file checks here
            }

            // Add general checks
        }
    }
}
